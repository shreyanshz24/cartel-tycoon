<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cartel Tycoon: Grand Strategy</title>
  <style>
    :root {
      --main-green: #00ff00;
      --main-red: #ff0000;
      --dark-bg: #0a0a0a;
      --card-bg: rgba(0, 20, 0, 0.7);
      --border-color: #003300;
      --player-color: #0077ff;
      --ai1-color: #ff7700;
      --ai2-color: #ff00ff;
      --ai3-color: #ffff00;
      --neutral-color: #555;
    }

    body {
      font-family: 'Courier New', monospace;
      background: var(--dark-bg);
      color: var(--main-green);
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    .container {
      display: none;
      padding: 15px;
      max-width: 1600px;
      margin: 0 auto;
      text-align: left;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 8px;
      margin-bottom: 10px;
    }

    .header h1 {
      font-size: 2rem;
      color: var(--main-red);
      text-shadow: 0 0 15px var(--main-red);
      margin: 0;
    }

    .top-stats-bar {
      display: flex;
      gap: 20px;
      background: var(--card-bg);
      padding: 5px 15px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    main {
      display: grid;
      grid-template-columns: 320px 1fr 320px;
      gap: 15px;
      height: calc(100vh - 100px);
    }

    .card {
      background: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0, 255, 0, 0.4);
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
    }

    h2 {
      border-bottom: 1px solid var(--main-green);
      padding-bottom: 4px;
      margin-top: 0;
      margin-bottom: 8px;
      font-size: 1.2rem;
    }

    h3 {
      font-size: 1rem;
      margin: 10px 0 5px 0;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 3px;
    }

    p {
      font-size: 0.9rem;
      line-height: 1.5;
      margin: 4px 0;
    }

    button {
      width: 100%;
      padding: 8px 10px;
      margin: 4px 0;
      background: var(--main-red);
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s ease;
      box-sizing: border-box;
      font-size: 0.9rem;
    }

    .tab-buttons {
      display: flex;
      border-bottom: 2px solid var(--border-color);
      margin-bottom: 10px;
    }

    .tab-link {
      background: none;
      border-radius: 6px 6px 0 0;
      border: 1px solid transparent;
      border-bottom: none;
      color: var(--main-green);
      opacity: 0.6;
      margin: 0 2px;
      flex-grow: 1;
      padding: 8px;
      font-size: 0.9rem;
    }

    .tab-link.active {
      background: var(--card-bg);
      border-color: var(--border-color);
      opacity: 1;
    }

    .tab-content {
      display: none;
      flex-grow: 1;
      overflow-y: auto;
    }

    .tab-content.active {
      display: block;
    }

    .item-list {
      overflow-y: auto;
      height: 100%;
    }

    .list-item {
      border-top: 1px solid var(--border-color);
      padding: 8px 0;
      margin-top: 8px;
    }

    #map-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 5px;
    }

    .territory {
      height: 60px;
      border: 2px solid #333;
      /* ... */
    }

    /* --- NEW: Music Player Styles --- */
    #music-player {
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--card-bg);
      padding: 5px 10px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    #song-title {
      font-size: 0.9rem;
      width: 250px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #music-player button {
      width: 40px;
      padding: 5px;
    }

    #youtube-player-container {
      display: none;
    }

    /* Hide the actual YouTube iframe */

    #menu {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      color: #f00;
      font-size: 3rem;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
    }

    #pauseBtn {
      width: 100px;
      background-color: #ffae00;
    }

    #pauseOverlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      color: #ffae00;
      font-size: 5rem;
      text-shadow: 0 0 15px #ffae00;
      justify-content: center;
      align-items: center;
      z-index: 999;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div id="menu">
    <h1>Cartel Tycoon</h1>
    <input type="text" id="playerName" placeholder="Enter Your Name"
      style="background:#000;border:1px solid #0f0;color:#0f0;padding:10px;text-align:center;font-family:'Courier New', monospace;margin:10px;">
    <div id="singlePlayerOptions">
      <label for="aiCount" style="font-size: 1.5rem; color: #0f0;">AI Opponents (1-3):</label>
      <input type="number" id="aiCount" value="2" min="1" max="3"
        style="background:#000;border:1px solid #0f0;color:#0f0;padding:10px;text-align:center;font-family:'Courier New', monospace;margin:10px;">
    </div>
    <button onclick="startGame('single')" style="width: 300px;">Single Player</button>
  </div>

  <div id="game" class="container">
    <header class="header">
      <h1>Cartel Tycoon</h1>
      <div id="music-player">
        <button onclick="prevSong()">‚èÆ</button>
        <span id="song-title">Loading Music...</span>
        <button onclick="nextSong()">‚è≠</button>
      </div>
      <div class="top-stats-bar" id="top-stats"></div>
      <button id="pauseBtn" onclick="togglePause()">Pause</button>
    </header>
    <main>
      <div class="card" id="operations"></div>
      <div class="card" id="center-panel"></div>
      <div class="card" id="personnel-inventory"></div>
    </main>
  </div>

  <div id="notifications"
    style="position:fixed;top:20px;right:20px;width:300px;z-index:1001;font-weight:bold;text-align:right;"></div>
  <div id="gameOverScreen"
    style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);color:#f00;font-size:3rem;justify-content:center;align-items:center;flex-direction:column;z-index:1000;">
    <h2 id="gameOverText"></h2><button onclick="location.reload()">Start Over</button>
  </div>
  <div id="pauseOverlay" onclick="togglePause()">PAUSED</div>
  <div id="event-modal"
    style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:2000;justify-content:center;align-items:center;">
    <div class="modal-content" id="event-content"
      style="width:500px;background:#0a0a0a;border:2px solid #f00;padding:20px;text-align:center;box-shadow:0 0 30px #f00;">
    </div>
  </div>
  <div id="territory-modal"
    style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:2000;justify-content:center;align-items:center;">
    <div class="modal-content" id="territory-modal-content"
      style="width:500px;background:#0a0a0a;border:2px solid #0f0;padding:20px;text-align:center;"></div>
  </div>
  <div id="youtube-player-container"></div>

  <script>
    // =================================================================================
    // SECTION 1: CORE GAME SETUP & STATE
    // =================================================================================
    let playerName = "";
    let gameData = {};
    let gameLoopInterval = null;
    let isPaused = false;
    let gameMode = 'single';
    let currentActiveTab = 'map-panel';
    let currentActiveSubTab = 'lieutenants-subpanel';
    let isAssigningLieutenant = -1;
    let ytPlayer; // Will hold the YouTube player object

    function resetGameData(aiCount = 2) {
      gameData = {
        money: 5000, whiteMoney: 0, heat: 0,
        inventory: { weed: 10, meth: 0, coke: 0, heroin: 0, fentanyl: 0, chemicals: 0 },
        armsStock: { handgun: 0, smg: 0, rifle: 0 },
        labLevel: 0, armsTier: 0, currentDrug: "weed",
        personnel: { producers: 0, dealers: 0, soldiers: 0, spies: 0 },
        lieutenants: [],
        personnelLoyalty: 70, payrollDue: 100,
        territories: [],
        aiPlayers: [],
        research: {
          logistics1: { name: 'Faster Couriers', desc: '+10% Dealer efficiency.', cost: 10000, time: 60, progress: 0, unlocked: false, requires: null },
          logistics2: { name: 'Bulk Chemicals', desc: 'Buy Chemicals in larger, cheaper batches.', cost: 50000, time: 120, progress: 0, unlocked: false, requires: 'logistics1' },
          military1: { name: 'Body Armor', desc: '+10% Soldier defense.', cost: 25000, time: 90, progress: 0, unlocked: false, requires: null },
          military2: { name: 'Assault Rifles', desc: '+15% Soldier attack power.', cost: 100000, time: 180, progress: 0, unlocked: false, requires: 'military1' },
          laundering1: { name: 'Shell Corps', desc: 'Lieutenants take a smaller cut.', cost: 75000, time: 150, progress: 0, unlocked: false, requires: null },
        },
        researchInProgress: null,
        victory: {
          domination: { current: 0, required: 15 },
          economic: { current: 0, required: 20000000 },
          status: 'Ongoing'
        },
        gameOver: false
      };
      // Initialize map, player, and AI territories
      const territoryNames = ["Docks", "Warehouse District", "Downtown", "Suburbs", "Projects", "West Side", "East Side", "Market", "Old Town", "The Strip", "Airport", "Industrial Park", "Southside", "Northbridge", "Chinatown"]; for (let i = 0; i < 15; i++) { gameData.territories.push({ id: i, name: territoryNames[i], owner: 'Neutral', value: Math.floor(Math.random() * 50) + 10, soldiers: 0, lieutenant: -1, business: null }) } gameData.territories[0].owner = 'Player'; gameData.territories[0].soldiers = 1; const aiNames = ["El Jefe", "La Reina", "The Ghost"]; for (let i = 0; i < aiCount; i++) { const aiId = `AI-${i + 1}`; gameData.territories[i + 1].owner = aiId; gameData.territories[i + 1].soldiers = 2; gameData.aiPlayers.push({ id: aiId, name: aiNames[i], money: 3000, powerLevel: 1, relationship: 0, spies: 1 }) }
    }

    // =================================================================================
    // SECTION 2: GAME START, LOOP, & PAUSE
    // =================================================================================

    function startGame(mode) {
      playerName = document.getElementById('playerName').value || "Player";
      gameMode = mode;
      document.getElementById('menu').style.display = 'none';
      if (gameMode === 'single') {
        const aiCount = parseInt(document.getElementById('aiCount').value) || 2;
        document.getElementById('game').style.display = 'block';
        resetGameData(aiCount);
        isPaused = false;
        gameLoopInterval = setInterval(gameLoop, 2000);
        updateUI();
      }
    }

    function gameLoop() {
      if (isPaused || gameData.gameOver) return;
      if (gameData.heat >= 200) triggerGameOver("BUSTED! The heat was too much.");
      runProduction();
      runLaundering();
      runPersonnelSystem();
      runEmpireManagement();
      runAiTurns();
      updateResearch();
      checkVictoryConditions();
      updateUI();
    }

    function togglePause() {
      if (gameData.gameOver) return;
      isPaused = !isPaused;
      const pauseBtn = document.getElementById('pauseBtn');
      const pauseOverlay = document.getElementById('pauseOverlay');
      if (isPaused) {
        clearInterval(gameLoopInterval);
        if (ytPlayer && typeof ytPlayer.pauseVideo === 'function') ytPlayer.pauseVideo();
        pauseBtn.textContent = "Resume";
        pauseOverlay.style.display = 'flex';
      } else {
        gameLoopInterval = setInterval(gameLoop, 2000);
        if (ytPlayer && typeof ytPlayer.playVideo === 'function') ytPlayer.playVideo();
        pauseBtn.textContent = "Pause";
        pauseOverlay.style.display = 'none';
      }
    }

    // =================================================================================
    // SECTION 3: YOUTUBE MUSIC PLAYER
    // =================================================================================
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    function onYouTubeIframeAPIReady() {
      ytPlayer = new YT.Player('youtube-player-container', {
        height: '1',
        width: '1',
        playerVars: {
          'autoplay': 1,
          'controls': 0,
          'loop': 1,
          'listType': 'playlist',
          'list': 'OLAK5uy_k2u2jXntExJQY_M3yTcX2AMmsJJSsDBB0'
        },
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerReady(event) {
      event.target.setVolume(50); // Set a reasonable volume
      event.target.playVideo();
    }

    function onPlayerStateChange(event) {
      if (event.data == YT.PlayerState.PLAYING) {
        const videoData = ytPlayer.getVideoData();
        document.getElementById('song-title').textContent = videoData.title;
      }
      // If a song ends, the playlist will automatically play the next one.
    }

    function nextSong() {
      if (ytPlayer) ytPlayer.nextVideo();
    }

    function prevSong() {
      if (ytPlayer) ytPlayer.previousVideo();
    }


    // =================================================================================
    // SECTION 4: CORE GAMEPLAY LOOPS
    // =================================================================================
    function handleButtonClick(actionFn, ...args) { if (isPaused) { showNotification("Game is paused!", "orange"); return; } actionFn(...args); if (gameMode === 'single') updateUI(); }
    function runProduction() { /* (Unchanged) */ }
    function runLaundering() { /* (Unchanged) */ }
    function runPersonnelSystem() { /* (Unchanged) */ }
    function runEmpireManagement() { /* (Unchanged) */ }

    // =================================================================================
    // SECTION 5: PLAYER ACTIONS
    // =================================================================================
    function hirePersonnel(type) { /* (Unchanged) */ }
    function assignLieutenant(ltIndex) { /* (Unchanged) */ }
    function upgradeLab() { /* (Unchanged) */ }
    function upgradeWorkshop() { /* (Unchanged) */ }
    function manufactureArms() { /* (Unchanged) */ }
    function sellArms() { /* (Unchanged) */ }
    function attackTerritory(territoryId) { /* (Unchanged) */ }
    function openTerritoryModal(territoryId) { /* (Unchanged) */ }
    function closeModal(modalId) { /* (Unchanged) */ }
    function buildBusiness(territoryId, type) { /* (Unchanged) */ }

    // =================================================================================
    // SECTION 6: ESPIONAGE, EVENTS, AI, DIPLOMACY
    // =================================================================================
    function launchSpyMission(targetAiIndex, missionType) { /* (Unchanged) */ }
    const events = [ /* (Unchanged) */];
    function triggerRandomEvent() { /* (Unchanged) */ }
    function resolveEvent(action) { /* (Unchanged) */ }
    function runAiTurns() { /* (Unchanged) */ }
    function proposeDeal(aiIndex) { /* (Unchanged) */ }

    // =================================================================================
    // SECTION 7: RESEARCH & DEVELOPMENT
    // =================================================================================
    function startResearch(researchId) { /* (Unchanged) */ }
    function updateResearch() { /* (Unchanged) */ }

    // =================================================================================
    // SECTION 8: VICTORY CONDITIONS
    // =================================================================================
    function checkVictoryConditions() { /* (Unchanged) */ }

    // =================================================================================
    // SECTION 9: UI RENDERING
    // =================================================================================
    function showTab(tabName, event) { /* (Unchanged) */ }
    function showSubTab(tabName, event) { /* (Unchanged) */ }

    function updateUI() {
      if (!gameData || gameData.gameOver) return;

      document.getElementById('top-stats').innerHTML = `<p>üí∞ Dirty: $${Math.floor(gameData.money)}</p> <p>üíµ Clean: $${Math.floor(gameData.whiteMoney)}</p> <p>üî• Heat: ${Math.floor(gameData.heat)}</p>`;
      document.getElementById('operations').innerHTML = `<h2>Operations</h2> <div class="item-list"> <h3>Drug Operation</h3> <p>Current Production: ${gameData.currentDrug}</p> <button onclick="handleButtonClick(upgradeLab)">Upgrade Lab</button> <h3>Arms Trafficking</h3> <p>Workshop Tier: ${gameData.armsTier}</p> <button onclick="handleButtonClick(upgradeWorkshop)">Upgrade Workshop</button> <button onclick="handleButtonClick(manufactureArms)">Manufacture Arms</button> <button onclick="handleButtonClick(sellArms)">Sell All Arms</button> </div>`;

      document.getElementById('center-panel').innerHTML = `<div class="tab-buttons"> <button class="tab-link" onclick="showTab('map-panel', event)">Map</button> <button class="tab-link" onclick="showTab('management-panel', event)">Management</button> <button class="tab-link" onclick="showTab('research-panel', event)">Research</button> </div> <div id="map-panel" class="tab-content"></div> <div id="management-panel" class="tab-content"></div> <div id="research-panel" class="tab-content"></div>`;

      let loyaltyColor = gameData.personnelLoyalty > 60 ? 'lightgreen' : gameData.personnelLoyalty > 30 ? 'orange' : 'red';
      document.getElementById('personnel-inventory').innerHTML = `<h2>Empire Stats</h2> <div class="item-list"><h3>Personnel</h3> <p><strong>Morale: <span style="color:${loyaltyColor};">${gameData.personnelLoyalty.toFixed(1)}%</span></strong></p> <p>Producers: ${gameData.personnel.producers}</p> <p>Dealers: ${gameData.personnel.dealers}</p> <p>Soldiers: ${gameData.personnel.soldiers}</p><p>Spies: ${gameData.personnel.spies}</p><hr><h3>Victory Progress</h3><p>Domination: ${gameData.victory.domination.current}/${gameData.victory.domination.required} Territories</p><p>Economic: $${Math.floor(gameData.victory.economic.current)}/$${gameData.victory.economic.required}</p></div>`;

      let mapHTML = `<h2>City Map ${isAssigningLieutenant > -1 ? '(ASSIGNING)' : ''}</h2><div id="map-grid">`;
      const ownerColors = { 'Player': 'player', 'AI-1': 'ai-1', 'AI-2': 'ai-2', 'AI-3': 'ai-3', 'Neutral': 'neutral' };
      gameData.territories.forEach(t => { let assignClass = isAssigningLieutenant > -1 && t.owner === 'Player' ? 'assign-mode' : ''; mapHTML += `<div class="territory ${ownerColors[t.owner]}-controlled ${assignClass}" onclick="handleButtonClick(openTerritoryModal, ${t.id})"><span>${t.name}</span><span>${t.lieutenant > -1 ? `‚òÖ ${gameData.lieutenants[t.lieutenant].name}` : `‚öîÔ∏è ${t.soldiers}`}</span></div>`; });
      mapHTML += `</div>`;
      document.getElementById('map-panel').innerHTML = mapHTML;

      document.getElementById('management-panel').innerHTML = `<div class="tab-buttons"><button class="tab-link" onclick="showSubTab('lieutenants-subpanel', event)">Lieutenants</button><button class="tab-link" onclick="showSubTab('diplomacy-subpanel', event)">Diplomacy</button><button class="tab-link" onclick="showSubTab('espionage-subpanel', event)">Espionage</button></div><div id="lieutenants-subpanel" class="tab-content item-list"></div><div id="diplomacy-subpanel" class="tab-content item-list"></div><div id="espionage-subpanel" class="tab-content item-list"></div>`;

      let lieutenantsHTML = `<h3>Lieutenants</h3><button onclick="handleButtonClick(hirePersonnel, 'lieutenant')">Hire Lieutenant ($50,000)</button>`;
      gameData.lieutenants.forEach((lt, index) => { let territory = gameData.territories.find(t => t.lieutenant === index); lieutenantsHTML += `<div class="list-item"><strong>${lt.name}</strong><p>Status: ${territory ? `Managing ${territory.name}` : 'Unassigned'}</p><button onclick="handleButtonClick(assignLieutenant, ${index})">${territory ? 'Re-Assign' : 'Assign'}</button></div>`; });
      document.getElementById('lieutenants-subpanel').innerHTML = lieutenantsHTML;

      let diplomacyHTML = `<h3>Rival Leaders</h3>`; gameData.aiPlayers.forEach((ai, index) => { let relPercent = (ai.relationship + 100) / 2; let totalSoldiers = gameData.territories.reduce((sum, t) => t.owner === ai.id ? sum + t.soldiers : sum, 0); diplomacyHTML += `<div class="list-item"> <strong>${ai.name}</strong> (‚öîÔ∏è ${totalSoldiers}) <div style="width:100%;height:8px;background:#333;border:1px solid #0f0;margin-top:5px;"><div style="width:${relPercent}%;height:100%;background:#0f0;"></div></div> <button onclick="handleButtonClick(proposeDeal, ${index})">Deal ($10k)</button> </div>`; });
      document.getElementById('diplomacy-panel').innerHTML = diplomacyHTML;

      let espionageHTML = `<h3>Espionage</h3><p>Spies Available: ${gameData.personnel.spies}</p><button onclick="handleButtonClick(hirePersonnel, 'spy')">Hire Spy ($25,000)</button><hr/>`;
      gameData.aiPlayers.forEach((ai, index) => { espionageHTML += `<div class="list-item"><strong>Target: ${ai.name}</strong><button onclick="handleButtonClick(launchSpyMission, ${index}, 'intel')">Gather Intel</button><button onclick="handleButtonClick(launchSpyMission, ${index}, 'sabotage')">Sabotage</button></div>`; });
      document.getElementById('espionage-subpanel').innerHTML = espionageHTML;

      let researchHTML = `<h2>Research & Development</h2><div id="research-grid">`;
      const trees = {
        'Logistics': ['logistics1', 'logistics2'],
        'Military': ['military1', 'military2'],
        'Laundering': ['laundering1']
      };
      for (const treeName in trees) {
        researchHTML += `<div><h3>${treeName}</h3>`;
        trees[treeName].forEach(researchId => {
          const r = gameData.research[researchId];
          let buttonHTML = '';
          if (r.unlocked) {
            buttonHTML = `<button disabled>Completed</button>`;
          } else if (gameData.researchInProgress === researchId) {
            const progressPercent = (r.progress / r.time) * 100;
            buttonHTML = `<div class="progress-bar" style="width:100%;background:#222;height:10px;border:1px solid #444;"><div class="progress-fill" style="height:100%;background:var(--main-green);width:${progressPercent}%"></div></div>`;
          } else {
            const requirementMet = r.requires ? gameData.research[r.requires].unlocked : true;
            buttonHTML = `<button onclick="handleButtonClick(startResearch, '${researchId}')" ${!requirementMet ? 'disabled' : ''}>Research ($${r.cost} C)</button>`;
          }
          researchHTML += `<div class="research-item" style="border:1px solid var(--border-color);padding:10px;border-radius:5px;"><p><strong>${r.name}</strong></p><p style="font-size:0.8rem;">${r.desc}</p>${buttonHTML}</div>`;
        });
        researchHTML += `</div>`;
      }
      researchHTML += `</div>`;
      document.getElementById('research-panel').innerHTML = researchHTML;

      // Set active tab logic
      document.querySelectorAll('.tab-content').forEach(tab => tab.style.display = 'none');
      document.querySelectorAll('#center-panel > .tab-buttons > .tab-link').forEach(link => link.classList.remove('active'));
      document.getElementById(currentActiveTab).style.display = 'block';
      const activeLink = document.querySelector(`.tab-link[onclick^="showTab('${currentActiveTab}'"]`);
      if (activeLink) activeLink.classList.add('active');

      if (currentActiveTab === 'management-panel') {
        document.querySelectorAll('.sub-tab-content').forEach(tab => tab.style.display = 'none');
        document.querySelectorAll('#management-panel .tab-link').forEach(link => link.classList.remove('active'));
        document.getElementById(currentActiveSubTab).style.display = 'block';
        const activeSubLink = document.querySelector(`.tab-link[onclick^="showSubTab('${currentActiveSubTab}'"]`);
        if (activeSubLink) activeSubLink.classList.add('active');
      }
    }

    // =================================================================================
    // SECTION 10: UTILITIES
    // =================================================================================
    function triggerGameOver(message) { gameData.gameOver = true; clearInterval(gameLoopInterval); document.getElementById('gameOverText').textContent = message; document.getElementById('gameOverScreen').style.display = 'flex'; }
    function showNotification(msg, color = "#0f0") { const n = document.createElement("div"); n.textContent = msg; n.style.color = "black"; n.style.background = color; n.style.padding = "5px 10px"; n.style.borderRadius = "5px"; n.style.marginTop = "5px"; document.getElementById('notifications').appendChild(n); setTimeout(() => n.remove(), 4000); }
  </script>
</body>

</html>
